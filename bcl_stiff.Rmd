---
title: "Bcl Inhibitors vs. Stiffness Analysis"
author: "Peter Higgins"
date: "2/19/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown for Reproducible Data Analysis

This is a reproducible analysis of data generated by Eva Rodansky in the Higgins Lab on several inhibitors of bcl provided by the Shaomeng Wang lab. These inhibitors were tested for their *anti-fibrotic activity* in the stiffness model of induction of fibrogenesis in *CCD-18co* human intestinal myofibroblasts on stiff plastic culture plates. 
For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

Three compounds were tested, BM1197, BM1244, and BM1252.

Each compound was tested at concentrations of 0.5, 1, 5, and 10 micromolar concentrations.

Each compound x dose was evaluated for mRNA gene expression on 4 genes: 

* Collagen (col1A1)
* Fibronectin (FN)
* Myosin light chain kinase (MYLK)
* Alpha smooth muscle actin (ACTA2)

Each compound x dose x gene analysis was perfomed in triplicate

```{r, include=FALSE}
library(tidyverse)
library(magrittr)
library(readxl)
library(ggplot2)
library(ggbeeswarm)
```

Will hide read in and clean up of data, renaming of variables
```{r, include=FALSE}
#read in data
stf <- read_excel("ESTF-131.xls", sheet=4)

stf$gene[stf$gene=="col1a1"]<- "Collagen COL1A1"
stf$gene[stf$gene=="fn1"]<- "Fibronectin FN1"
stf$gene[stf$gene=="ACTA2"]<- "Alpha Smooth Muscle Actin ACTA2"
stf$gene[stf$gene=="MYLK"]<- "Myosin Light Chain Kinase MYLK"
stf$rx <- as.factor(stf$rx)
stf$gene <- as.factor(stf$gene)
stf$micromolar<- as.factor(stf$micromolar)
```

## Exploratory Data Analysis

#What is the effect by gene x dose for BM1197?
``` {r, echo=FALSE}
stf %>%
  filter(rx=="BM1197") %>%
  ggplot(aes(x=micromolar, y=dct, color=rx)) +
  facet_grid(rx ~ gene) +
  geom_quasirandom(dodge.width = 1, color=2) +  
  ggtitle("BM1197 in vitro vs. Stiffness Induction of Fibrogenic Genes") +
  labs(x="Dose (micromolar)") + labs(y="dCt") +
  guides(color=guide_legend(title="Drug")) +
  theme(legend.position = "top")
```
  
#What is effect by gene x dose for BM1244?
```{r, echo=FALSE}
stf %>%
  filter(rx=="BM1244") %>%
  ggplot(aes(x=micromolar, y=dct, color=rx)) +
  facet_grid(rx ~ gene) +
  geom_quasirandom(dodge.width = 1, color=3) +  
  ggtitle("BM1244 in vitro vs. Stiffness Induction of Fibrogenic Genes") +
  labs(x="Dose (micromolar)") + labs(y="dCt") +
  guides(color=guide_legend(title="Drug")) +
  theme(legend.position = "top")
```

#What is effect by gene, by dose for BM1252?
```{r, echo=FALSE}
stf %>%
  filter(rx=="BM1252") %>%
  ggplot(aes(x=micromolar, y=dct, color=rx)) +
  facet_grid(rx ~ gene) +
  geom_quasirandom(dodge.width = 1, color=4) +  
  ggtitle("BM1252 in vitro vs. Stiffness Induction of Fibrogenic Genes") +
  labs(x="Dose (micromolar)") + labs(y="dCt") +
  guides(color=guide_legend(title="Drug")) +
  theme(legend.position = "top")
```

##Put it all together
#What is effect by gene, by drug, by dose - All drugs?
```{r}
ggplot(data= stf, aes(x=micromolar, y=dct, color=rx)) +
  facet_grid(rx ~ gene) +
  geom_quasirandom(dodge.width = 1) +  
  ggtitle("Bcl inhibitors in vitro vs. Stiffness Induction of Fibrogenic Genes") +
  labs(x="Dose (micromolar)") + labs(y="dCt") +
  guides(color=guide_legend(title="Drug")) +
  theme(legend.position = "top")
```
